![](https://github.com/Nahid1992/CAD_PE/blob/main/figures/Tittle_Logo_MedIA.png)
<!-- # Seeking an Optimal Approach for Computer-aided Pulmonary Embolism Detection -->
Pulmonary embolism (PE) represents a blood clot that travels to the blood vessels in the lung, causing vascular obstruction, and in some patients, death. CT pulmonary angiography (CTPA), is the most common type of medical imaging to evaluate patients with suspected PE. These CT scans consist of hundreds of images that require detailed review to identify clots within the pulmonary arteries. Recent research in deep learning across academia and industry produced numerous architectures, various model initializations, and distinct learning paradigms. It has resulted in many competing approaches to Computer-aided Diagnosis (CAD) implementation in medical imaging and produced great confusion in the CAD community. We have conducted extensive experiments with various deep learning architectures, model initializations, learning paradigms, and data pre-processing techniques applicable for PE diagnosis at both the slice and exam levels.
 
 ![](https://github.com/Nahid1992/CAD_PE/blob/main/figures/WorlFlow_MedIA.jpg)
 
## Publication
**Seeking an Optimal Approach for Computer-aided Pulmonary Embolism Detection** <br/>
[Nahid Ul Islam](https://github.com/Nahid1992)<sup>1</sup>, [Shiv Gehlot](https://github.com/shivgahlout)<sup>1</sup>, [Zongwei Zhou](https://github.com/MrGiovanni)<sup>1</sup>, [Michael B Gotway](https://www.mayoclinic.org/biographies/gotway-michael-b-m-d/bio-20055566)<sup>2</sup>, and [Jianming Liang](https://chs.asu.edu/jianming-liang)<sup>1</sup><br/>
<sup>1</sup>Arizona State University, <sup>2</sup>Mayo Clinic<br/>
International Conference on Medical Image Computing and Computer Assisted Intervention ([MICCAI 2021](https://www.miccai2021.org/)); Machine Learning in Medical Imaging ([MLMI2021](https://sites.google.com/view/mlmi2021/))<br/>
[Paper](https://arxiv.org/pdf/2109.07029.pdf) | [Graphical Abstract](https://github.com/Nahid1992/CAD_PE/blob/main/figures/MLMI2021_Graphical_abstract.pdf) | [Poster](https://github.com/Nahid1992/CAD_PE/blob/main/figures/MLMI2021_PE_Poster.pdf) | [Code](https://github.com/Nahid1992/CAD_PE) | [Slides](https://github.com/Nahid1992/CAD_PE/blob/main/figures/MLMI2021_Presentation.pdf) | [Presentation](https://youtu.be/LivPIQ0D0-g)<br/><br/>

**Seeking an Optimal Approach for Computer-aided Diagnosis of Pulmonary Embolism** <br/>
[Nahid Ul Islam](https://github.com/Nahid1992)<sup>1</sup>, [Zongwei Zhou](https://github.com/MrGiovanni)<sup>1</sup>, [Shiv Gehlot](https://github.com/shivgahlout)<sup>1</sup>, [Michael B Gotway](https://www.mayoclinic.org/biographies/gotway-michael-b-m-d/bio-20055566)<sup>2</sup>, and [Jianming Liang](https://chs.asu.edu/jianming-liang)<sup>1</sup><br/>
<sup>1</sup>Arizona State University, <sup>2</sup>Mayo Clinic<br/>
[Medical Image Analysis (MedIA)](https://www.sciencedirect.com/journal/medical-image-analysis)<br/>
[Paper](https://www.sciencedirect.com/science/article/pii/S1361841523002487) | [Graphical Abstract](https://github.com/Nahid1992/CAD_PE/blob/main/figures/PE_Graphical_Abstract.pdf) | [Poster](https://github.com/Nahid1992/CAD_PE/blob/main/figures/MedIA_PE_Journal_v9.pdf) | [Code](https://github.com/Nahid1992/CAD_PE) | [Slides](MedIA_30mins_Presentation_v6_PDF) | [Presentation](https://www.dropbox.com/scl/fi/lkwm2dia274uf51qpobkv/MedIA_30mins_Presentation_v6.pptx?rlkey=8khn61a3zm5p7mw1kbkb1tqdz&dl=0))

## Dataset
1. [RSNA PE](https://www.kaggle.com/c/rsna-str-pulmonary-embolism-detection)
2. [CAD-PE Challenge Dataset](https://ieee-dataport.org/open-access/cad-pe)
3. [Ferdowsi University of Mashhad's PE dataset](https://www.kaggle.com/andrewmvd/pulmonary-embolism-in-ct-images)
4. [Our in-house PE-CAD dataset](https://pubmed.ncbi.nlm.nih.gov/31416007/)

## Major results from our work
**1. Transfer learning boosts performance despite differences between photographic images and CTPA scans**
<p align="left">
<img src="https://github.com/Nahid1992/CAD_PE/blob/main/figures/J_Backbone_Random_vs_ImageNet_v3.jpg" width=70% height=70%>
</p>

**2. Squeeze & excitation blocks enhance CNN performance**
<p align="left">
<img src="https://github.com/Nahid1992/CAD_PE/blob/main/figures/J_Backbone_w_o_SEblock.jpg" width=70% height=70%>
</p>
 
**3. Self-supervised pre-training can surpass (fully) supervised pre-training**
<p align="left">
<img src="https://github.com/Nahid1992/CAD_PE/blob/main/figures/J_Backbone_ResNet50_SSL.jpg" width=70% height=70%>
</p>

**4. Model trained on the RSNA PE dataset demonstrates promising performance when tested on unseen datasets for slice-level PE classification**
<p align="left">
<img src="https://github.com/Nahid1992/CAD_PE/blob/main/figures/fig_CADPE_FUMPE_GradCam.jpg" width=70% height=70%>
</p>
 
**5. Proposed Embedding-based ViT (E-ViT) utilizes class and exam-level embeddings generated by the transformer encoder and outperforms BiGRU**
<p align="left">
<img src="https://github.com/Nahid1992/CAD_PE/blob/main/figures/J_figure_ViTnew_Zongwei_Nahid_v4.jpg" width=70% height=70%>
<img src="https://github.com/Nahid1992/CAD_PE/blob/main/figures/EViTResults.jpg" width=70% height=70%>
</p>

**6. Vessel-oriented image representation and self-supervised pre-training both enhance performance for PE false positive reduction across image dimensions.**
<p align="left">
<img src="https://github.com/Nahid1992/CAD_PE/blob/main/figures/VOIR_Results.jpg" width=70% height=70%>
</p>

## Data organization and preprocessing steps
This framework was built on top of the first place solution. The necessary data organization as well as the preprocessing steps can be found [here](https://github.com/GuanshuoXu/RSNA-STR-Pulmonary-Embolism-Detection).

## SeXception pre-trained weights
Insprired from SeResNet50 and SeResNext50, we added [squeeze and excitation](https://github.com/hujie-frank/SENet) (SE) block to Xception architecture and pre-trained it on ImageNet dataset. The pre-trained SeXception model can be found [here](https://www.dropbox.com/scl/fi/smcbb6xzmq3gsm379cvoi/sexception_imagenet_pretrainedweight.pth.tar?rlkey=nyfltetkacsexwru7m5kfejmb&dl=0).

## Pre-trained models
You can download the pretrained models used/developed in our paper from [here](https://www.dropbox.com/scl/fo/gpe5tj0bemns4kwqfx5x2/h?rlkey=exufmulsz8zcgg39hwdrhlypt&dl=0).

## Citation
If you use this code or use our pre-trained weights for your research, please cite our paper:

```
@misc{islam2021seeking,
  title={Seeking an Optimal Approach for Computer-Aided Pulmonary Embolism Detection},
  author={Islam, Nahid Ul and Gehlot, Shiv and Zhou, Zongwei and Gotway, Michael B and Liang, Jianming},
  journal={arXiv preprint arXiv:2109.07029},
  year={2021}
}
```

## Acknowledgement
This research has been supported in part by ASU and Mayo Clinic through a Seed Grant and an Innovation Grant, and in part by the NIH under Award Number R01HL128785. The content is solely the responsibility of the authors and does not necessarily represent the official views of the NIH. This work has utilized the GPUs, made avail-able in part by ASU Research Computing, Bridges-2 at the Pittsburgh Supercomputing Center (allocated under BCS190015), and Anvil at Purdue University (allocated under MED220025), all of which are sup-ported by the Advanced Cyberinfrastructure Coordination Ecosystem: Services & Support (ACCESS) program. This program is supported by National Science Foundation grants #2138259, #2138286, #2138307, #2137603, and #2138296. We thank Ruibin Feng for aggregating 19self-supervised pre-trained models and Jae Shin and Douglas Amoo-Sargon for creating the 3D VOIR dataset. We also acknowledge the exploration and preliminary experiments by Utkarsh Nath, which have been redesigned and replaced in this version. We extend our gratitude to Zuwei Guo for his efforts in preparing the pre-trained models for the latest 3D self-supervised approaches and for his contributions in experimenting with the 3D VOIR target task. The content of this paper is covered by patents pending.

## License
Released under the [ASU GitHub Project License](https://github.com/Nahid1992/CAD_PE/blob/main/LICENSE)

